Add test case for W [U6PMOt] line 2.2
Refactor codebase with Z [eZ7vKV] line 3.1
